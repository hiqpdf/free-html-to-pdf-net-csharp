<pre style='color: #000000; background: #ffffff;'><span style='color:#800000; font-weight:bold; '>Imports</span> <span style='color:#800000; font-weight:bold; '>System</span><span style='color:#008c00; '>.</span>Web<span style='color:#008c00; '>.</span>UI
<span style='color:#800000; font-weight:bold; '>Imports</span> <span style='color:#800000; font-weight:bold; '>System</span><span style='color:#008c00; '>.</span>Web<span style='color:#008c00; '>.</span>UI<span style='color:#008c00; '>.</span>WebControls

<span style='color:#800000; font-weight:bold; '>Imports</span> HiQPdf

<span style='color:#800000; font-weight:bold; '>Namespace</span> HiQPdf_Demo
    Partial <span style='color:#800000; font-weight:bold; '>Public</span> <span style='color:#800000; font-weight:bold; '>Class</span> PdfTextDemo
        <span style='color:#800000; font-weight:bold; '>Inherits</span> <span style='color:#800000; font-weight:bold; '>System</span><span style='color:#008c00; '>.</span>Web<span style='color:#008c00; '>.</span>UI<span style='color:#008c00; '>.</span>Page
        <span style='color:#800000; font-weight:bold; '>Protected</span> <span style='color:#800000; font-weight:bold; '>Sub</span> buttonCreatePdf_Click<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>ByVal</span> sender <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Object</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ByVal</span> e <span style='color:#800000; font-weight:bold; '>As</span> EventArgs<span style='color:#808030; '>)</span>
            <span style='color:#696969; '>' create a PDF document</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> document <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfDocument<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' set a demo serial number</span>
            document<span style='color:#008c00; '>.</span>SerialNumber <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"YCgJMTAE-BiwJAhIB-EhlWTlBA-UEBRQFBA-U1FOUVJO-WVlZWQ=="</span>

            <span style='color:#696969; '>' create a page in document</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> page1 <span style='color:#800000; font-weight:bold; '>As</span> PdfPage <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>AddPage<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' create the true type fonts that can be used in document text</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> sysFont <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> Font<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Times New Roman"</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span><span style='color:#808030; '>,</span> GraphicsUnit<span style='color:#008c00; '>.</span>Point<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> pdfFont <span style='color:#800000; font-weight:bold; '>As</span> PdfFont <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFont<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> pdfFontEmbed <span style='color:#800000; font-weight:bold; '>As</span> PdfFont <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFont<span style='color:#808030; '>,</span> <span style='color:#0f4d75; '>True</span><span style='color:#808030; '>)</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> sysFontBold <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> Font<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Times New Roman"</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span><span style='color:#808030; '>,</span> FontStyle<span style='color:#008c00; '>.</span>Bold<span style='color:#808030; '>,</span> GraphicsUnit<span style='color:#008c00; '>.</span>Point<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> pdfFontBold <span style='color:#800000; font-weight:bold; '>As</span> PdfFont <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFontBold<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> pdfFontBoldEmbed <span style='color:#800000; font-weight:bold; '>As</span> PdfFont <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFontBold<span style='color:#808030; '>,</span> <span style='color:#0f4d75; '>True</span><span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' create a standard Helvetica Type 1 font that can be used in document text</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> helveticaStdFont <span style='color:#800000; font-weight:bold; '>As</span> PdfFont <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>CreateStandardFont<span style='color:#808030; '>(</span>PdfStandardFont<span style='color:#008c00; '>.</span>Helvetica<span style='color:#808030; '>)</span>
            helveticaStdFont<span style='color:#008c00; '>.</span>Size <span style='color:#808030; '>=</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> crtYPos <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Single</span> <span style='color:#808030; '>=</span> <span style='color:#008c00; '>20</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> crtXPos <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Single</span> <span style='color:#808030; '>=</span> <span style='color:#008c00; '>5</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> textLayoutInfo <span style='color:#800000; font-weight:bold; '>As</span> PdfLayoutInfo <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>Nothing</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> dummyText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>String</span> <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum."</span>

<span style='color:#696969; '>'			#Region "Layout a text that expands to the right edge of the PDF page"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> titleTextAtLocation <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"The text below extends from the layout position to the right edge of the PDF page:"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span>
            titleTextAtLocation<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Navy
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextAtLocation<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> textExpandsToRightEdge <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span>
            textExpandsToRightEdge<span style='color:#008c00; '>.</span>BackColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>WhiteSmoke
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>textExpandsToRightEdge<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' draw a rectangle around the text</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> borderPdfRectangle <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span>
            borderPdfRectangle<span style='color:#008c00; '>.</span>LineStyle<span style='color:#008c00; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0.</span>5f
            page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

<span style='color:#696969; '>'			#End Region</span>

<span style='color:#696969; '>'			#Region "Layout a text with width limit"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> titleTextWithWidth <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"The text below is limited by a given width and has a free height:"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span>
            titleTextWithWidth<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Navy
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextWithWidth<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> textWithWidthLimit <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span>
            textWithWidthLimit<span style='color:#008c00; '>.</span>BackColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>WhiteSmoke
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>textWithWidthLimit<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' draw a rectangle around the text</span>
            borderPdfRectangle <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span>
            borderPdfRectangle<span style='color:#008c00; '>.</span>LineStyle<span style='color:#008c00; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0.</span>5f
            page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

<span style='color:#696969; '>'			#End Region</span>

<span style='color:#696969; '>'			#Region "Layout a text with width and height limits"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> titleTextWithWidthAndHeight <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"The text below is limited by a given width and height and is trimmed:"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span>
            titleTextWithWidthAndHeight<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Navy
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextWithWidthAndHeight<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> textWithWidthAndHeightLimit <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span>
            textWithWidthAndHeightLimit<span style='color:#008c00; '>.</span>BackColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>WhiteSmoke
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>textWithWidthAndHeightLimit<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' draw a rectangle around the text</span>
            borderPdfRectangle <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span>
            borderPdfRectangle<span style='color:#008c00; '>.</span>LineStyle<span style='color:#008c00; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0.</span>5f
            page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

<span style='color:#696969; '>'			#End Region</span>

<span style='color:#696969; '>'			#Region "Layout a text with standard font"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> textWithStandardFont <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"This green text is written with a Helvetica Standard Type 1 font"</span><span style='color:#808030; '>,</span> helveticaStdFont<span style='color:#808030; '>)</span>
            textWithStandardFont<span style='color:#008c00; '>.</span>BackColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>WhiteSmoke
            textWithStandardFont<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Green
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>textWithStandardFont<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

<span style='color:#696969; '>'			#End Region</span>

<span style='color:#696969; '>'			#Region "Layout a rotated text"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> titleRotatedText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"The text below is rotated:"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span>
            titleRotatedText<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Navy
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>titleRotatedText<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#696969; '>' create a reference Graphics used for measuring</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> refBmp <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> Bitmap<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> refGraphics <span style='color:#800000; font-weight:bold; '>As</span> Graphics <span style='color:#808030; '>=</span> Graphics<span style='color:#008c00; '>.</span>FromImage<span style='color:#808030; '>(</span>refBmp<span style='color:#808030; '>)</span>
            refGraphics<span style='color:#008c00; '>.</span>PageUnit <span style='color:#808030; '>=</span> GraphicsUnit<span style='color:#008c00; '>.</span>Point

            <span style='color:#800000; font-weight:bold; '>Dim</span> counterRotatedText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>String</span> <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"This text is rotated 45 degrees counter clockwise"</span>

            <span style='color:#696969; '>' measure the rotated text size</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> counterRotatedTextSize <span style='color:#800000; font-weight:bold; '>As</span> SizeF <span style='color:#808030; '>=</span> refGraphics<span style='color:#008c00; '>.</span>MeasureString<span style='color:#808030; '>(</span>counterRotatedText<span style='color:#808030; '>,</span> sysFont<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> counterRotatedTextSize<span style='color:#008c00; '>.</span>Width <span style='color:#808030; '>/</span> <span style='color:#800000; font-weight:bold; '>CSng</span><span style='color:#808030; '>(</span>Math<span style='color:#008c00; '>.</span>Sqrt<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> clockwiseRotatedText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>String</span> <span style='color:#808030; '>=</span> <span style='color:#0000e6; '>"This text is rotated 45 degrees clockwise"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> rotatedCounterClockwiseText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>100</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> counterRotatedText<span style='color:#808030; '>,</span> pdfFontEmbed<span style='color:#808030; '>)</span>
            rotatedCounterClockwiseText<span style='color:#008c00; '>.</span>RotationAngle <span style='color:#808030; '>=</span> <span style='color:#008c00; '>45</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>rotatedCounterClockwiseText<span style='color:#808030; '>)</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> rotatedClockwiseText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>100</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> clockwiseRotatedText<span style='color:#808030; '>,</span> pdfFontEmbed<span style='color:#808030; '>)</span>
            rotatedClockwiseText<span style='color:#008c00; '>.</span>RotationAngle <span style='color:#808030; '>=</span> <span style='color:#808030; '>-</span><span style='color:#008c00; '>45</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>rotatedClockwiseText<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' measure the rotated text size</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> clockwiseRotatedTextSize <span style='color:#800000; font-weight:bold; '>As</span> SizeF <span style='color:#808030; '>=</span> refGraphics<span style='color:#008c00; '>.</span>MeasureString<span style='color:#808030; '>(</span>clockwiseRotatedText<span style='color:#808030; '>,</span> sysFont<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> clockwiseRotatedTextSize<span style='color:#008c00; '>.</span>Width <span style='color:#808030; '>/</span> <span style='color:#800000; font-weight:bold; '>CSng</span><span style='color:#808030; '>(</span>Math<span style='color:#008c00; '>.</span>Sqrt<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#696969; '>' dispose the graphics used for measuring</span>
            refGraphics<span style='color:#008c00; '>.</span>Dispose<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
            refBmp<span style='color:#008c00; '>.</span>Dispose<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>

<span style='color:#696969; '>'			#End Region</span>

<span style='color:#696969; '>'			#Region "Layout an automatically paginated text"</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> dummyBigText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>String</span> <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>System</span><span style='color:#008c00; '>.</span>IO<span style='color:#008c00; '>.</span>File<span style='color:#008c00; '>.</span>ReadAllText<span style='color:#808030; '>(</span>Server<span style='color:#008c00; '>.</span>MapPath<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"~"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>&amp;</span> <span style='color:#0000e6; '>"\DemoFiles\Text\DummyBigText.txt"</span><span style='color:#808030; '>)</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> titleTextPaginated <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"The text below is automatically paginated when it gets to the bottom of this page:"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span>
            titleTextPaginated<span style='color:#008c00; '>.</span>ForeColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>Navy
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextPaginated<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

            <span style='color:#800000; font-weight:bold; '>Dim</span> paginatedText <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> dummyBigText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span>
            paginatedText<span style='color:#008c00; '>.</span>BackColor <span style='color:#808030; '>=</span> Color<span style='color:#008c00; '>.</span>WhiteSmoke
            paginatedText<span style='color:#008c00; '>.</span>Cropping <span style='color:#808030; '>=</span> <span style='color:#0f4d75; '>False</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>paginatedText<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' get the last page where the text was rendered</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> crtPage <span style='color:#800000; font-weight:bold; '>As</span> PdfPage <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>Pages<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageIndex<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' draw a line at the bottom of the text on the second page</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> leftPoint <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PointF<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span><span style='color:#800000; font-weight:bold; '>Left</span><span style='color:#808030; '>,</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Bottom<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> rightPoint <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PointF<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span><span style='color:#800000; font-weight:bold; '>Right</span><span style='color:#808030; '>,</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Bottom<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Dim</span> borderLine <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>New</span> PdfLine<span style='color:#808030; '>(</span>leftPoint<span style='color:#808030; '>,</span> rightPoint<span style='color:#808030; '>)</span>
            borderLine<span style='color:#008c00; '>.</span>LineStyle<span style='color:#008c00; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008c00; '>0.</span>5f
            crtPage<span style='color:#008c00; '>.</span>Layout<span style='color:#808030; '>(</span>borderLine<span style='color:#808030; '>)</span>

            <span style='color:#696969; '>' advance the Y position in the second PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#008c00; '>.</span>LastPageRectangle<span style='color:#008c00; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span>

<span style='color:#696969; '>'			#End Region</span>

            <span style='color:#800000; font-weight:bold; '>Try</span>
                <span style='color:#696969; '>' write the PDF document to a memory buffer</span>
                <span style='color:#800000; font-weight:bold; '>Dim</span> pdfBuffer<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span> <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Byte</span> <span style='color:#808030; '>=</span> document<span style='color:#008c00; '>.</span>WriteToMemory<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>

                <span style='color:#696969; '>' inform the browser about the binary data format</span>
                HttpContext<span style='color:#008c00; '>.</span>Current<span style='color:#008c00; '>.</span>Response<span style='color:#008c00; '>.</span>AddHeader<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Content-Type"</span><span style='color:#808030; '>,</span> <span style='color:#0000e6; '>"application/pdf"</span><span style='color:#808030; '>)</span>

                <span style='color:#696969; '>' let the browser know how to open the PDF document and the file name</span>
                HttpContext<span style='color:#008c00; '>.</span>Current<span style='color:#008c00; '>.</span>Response<span style='color:#008c00; '>.</span>AddHeader<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"Content-Disposition"</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>String</span><span style='color:#008c00; '>.</span><span style='color:#800000; font-weight:bold; '>Format</span><span style='color:#808030; '>(</span><span style='color:#0000e6; '>"attachment; filename=PdfText.pdf; size={0}"</span><span style='color:#808030; '>,</span> pdfBuffer<span style='color:#008c00; '>.</span>Length<span style='color:#008c00; '>.</span>ToString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span>

                <span style='color:#696969; '>' write the PDF buffer to HTTP response</span>
                HttpContext<span style='color:#008c00; '>.</span>Current<span style='color:#008c00; '>.</span>Response<span style='color:#008c00; '>.</span>BinaryWrite<span style='color:#808030; '>(</span>pdfBuffer<span style='color:#808030; '>)</span>

                <span style='color:#696969; '>' call End() method of HTTP response to stop ASP.NET page processing</span>
                HttpContext<span style='color:#008c00; '>.</span>Current<span style='color:#008c00; '>.</span>Response<span style='color:#008c00; '>.</span><span style='color:#800000; font-weight:bold; '>End</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>Finally</span>
                document<span style='color:#008c00; '>.</span><span style='color:#800000; font-weight:bold; '>Close</span><span style='color:#808030; '>(</span><span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Try</span>
        <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Sub</span>

        <span style='color:#800000; font-weight:bold; '>Protected</span> <span style='color:#800000; font-weight:bold; '>Sub</span> Page_Load<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>ByVal</span> sender <span style='color:#800000; font-weight:bold; '>As</span> <span style='color:#800000; font-weight:bold; '>Object</span><span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>ByVal</span> e <span style='color:#800000; font-weight:bold; '>As</span> EventArgs<span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>If</span> <span style='color:#800000; font-weight:bold; '>Not</span> IsPostBack <span style='color:#800000; font-weight:bold; '>Then</span>
                Master<span style='color:#008c00; '>.</span>SelectNode<span style='color:#808030; '>(</span><span style='color:#0000e6; '>"pdfText"</span><span style='color:#808030; '>)</span>
            <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>If</span>
        <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Sub</span>
    <span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Class</span>
<span style='color:#800000; font-weight:bold; '>End</span> <span style='color:#800000; font-weight:bold; '>Namespace</span>
</pre>
