<pre style='color: #000000; background: #ffffff;'><span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Collections<span style='color:#808030; '>.</span>Generic<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>UI<span style='color:#800080; '>;</span>
<span style='color:#800000; font-weight:bold; '>using</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>UI<span style='color:#808030; '>.</span>WebControls<span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>using</span> HiQPdf<span style='color:#800080; '>;</span>

<span style='color:#800000; font-weight:bold; '>namespace</span> HiQPdf_Demo
<span style='color:#800080; '>{</span>
    <span style='color:#800000; font-weight:bold; '>public</span> partial <span style='color:#800000; font-weight:bold; '>class</span> PdfTextDemo <span style='color:#808030; '>:</span> System<span style='color:#808030; '>.</span>Web<span style='color:#808030; '>.</span>UI<span style='color:#808030; '>.</span>Page
    <span style='color:#800080; '>{</span>
        <span style='color:#800000; font-weight:bold; '>protected</span> <span style='color:#800000; font-weight:bold; '>void</span> buttonCreatePdf_Click<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>object</span> sender<span style='color:#808030; '>,</span> EventArgs e<span style='color:#808030; '>)</span>
        <span style='color:#800080; '>{</span>
            <span style='color:#696969; '>// create a PDF document</span>
            PdfDocument document <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfDocument<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// set a demo serial number</span>
            document<span style='color:#808030; '>.</span>SerialNumber <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>YCgJMTAE-BiwJAhIB-EhlWTlBA-UEBRQFBA-U1FOUVJO-WVlZWQ==</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// create a page in document</span>
            PdfPage page1 <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>AddPage<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// create the true type fonts that can be used in document text</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Font sysFont <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Font<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Times New Roman</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span><span style='color:#808030; '>,</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>GraphicsUnit<span style='color:#808030; '>.</span>Point<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            PdfFont pdfFont <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            PdfFont pdfFontEmbed <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFont<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Font sysFontBold <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Font<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Times New Roman</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>10</span><span style='color:#808030; '>,</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>FontStyle<span style='color:#808030; '>.</span>Bold<span style='color:#808030; '>,</span>
                            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>GraphicsUnit<span style='color:#808030; '>.</span>Point<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            PdfFont pdfFontBold <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFontBold<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            PdfFont pdfFontBoldEmbed <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>CreateFont<span style='color:#808030; '>(</span>sysFontBold<span style='color:#808030; '>,</span> <span style='color:#800000; font-weight:bold; '>true</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// create a standard Helvetica Type 1 font that can be used in document text</span>
            PdfFont helveticaStdFont <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>CreateStandardFont<span style='color:#808030; '>(</span>PdfStandardFont<span style='color:#808030; '>.</span>Helvetica<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            helveticaStdFont<span style='color:#808030; '>.</span>Size <span style='color:#808030; '>=</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            <span style='color:#800000; font-weight:bold; '>float</span> crtYPos <span style='color:#808030; '>=</span> <span style='color:#008c00; '>20</span><span style='color:#800080; '>;</span>
            <span style='color:#800000; font-weight:bold; '>float</span> crtXPos <span style='color:#808030; '>=</span> <span style='color:#008c00; '>5</span><span style='color:#800080; '>;</span>

            PdfLayoutInfo textLayoutInfo <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>null</span><span style='color:#800080; '>;</span>

            <span style='color:#800000; font-weight:bold; '>string</span> dummyText <span style='color:#808030; '>=</span> <span style='color:#800000; '>@"</span><span style='color:#0000e6; '>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout a text that expands to the right edge of the PDF page</span>

            PdfText titleTextAtLocation <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span>
                    <span style='color:#800000; '>"</span><span style='color:#0000e6; '>The text below extends from the layout position to the right edge of the PDF page:</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            titleTextAtLocation<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Navy<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextAtLocation<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            PdfText textExpandsToRightEdge <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            textExpandsToRightEdge<span style='color:#808030; '>.</span>BackColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>WhiteSmoke<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>textExpandsToRightEdge<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// draw a rectangle around the text</span>
            PdfRectangle borderPdfRectangle <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            borderPdfRectangle<span style='color:#808030; '>.</span>LineStyle<span style='color:#808030; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span><span style='color:#006600; '>f</span><span style='color:#800080; '>;</span>
            page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout a text with width limit</span>

            PdfText titleTextWithWidth <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span>
                    <span style='color:#800000; '>"</span><span style='color:#0000e6; '>The text below is limited by a given width and has a free height:</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            titleTextWithWidth<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Navy<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextWithWidth<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            PdfText textWithWidthLimit <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            textWithWidthLimit<span style='color:#808030; '>.</span>BackColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>WhiteSmoke<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>textWithWidthLimit<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// draw a rectangle around the text</span>
            borderPdfRectangle <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            borderPdfRectangle<span style='color:#808030; '>.</span>LineStyle<span style='color:#808030; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span><span style='color:#006600; '>f</span><span style='color:#800080; '>;</span>
            page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout a text with width and height limits</span>

            PdfText titleTextWithWidthAndHeight <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span>
                    <span style='color:#800000; '>"</span><span style='color:#0000e6; '>The text below is limited by a given width and height and is trimmed:</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            titleTextWithWidthAndHeight<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Navy<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextWithWidthAndHeight<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            PdfText textWithWidthAndHeightLimit <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> dummyText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            textWithWidthAndHeightLimit<span style='color:#808030; '>.</span>BackColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>WhiteSmoke<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>textWithWidthAndHeightLimit<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// draw a rectangle around the text</span>
            borderPdfRectangle <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfRectangle<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            borderPdfRectangle<span style='color:#808030; '>.</span>LineStyle<span style='color:#808030; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span><span style='color:#006600; '>f</span><span style='color:#800080; '>;</span>
            page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>borderPdfRectangle<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout a text with standard font</span>

            PdfText textWithStandardFont <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>This green text is written with a Helvetica Standard Type 1 font</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> helveticaStdFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            textWithStandardFont<span style='color:#808030; '>.</span>BackColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>WhiteSmoke<span style='color:#800080; '>;</span>
            textWithStandardFont<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Green<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>textWithStandardFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout a rotated text</span>

            PdfText titleRotatedText <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>The text below is rotated:</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            titleRotatedText<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Navy<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>titleRotatedText<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// create a reference Graphics used for measuring</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Bitmap refBmp <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Bitmap<span style='color:#808030; '>(</span><span style='color:#008c00; '>1</span><span style='color:#808030; '>,</span> <span style='color:#008c00; '>1</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Graphics refGraphics <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Graphics<span style='color:#808030; '>.</span>FromImage<span style='color:#808030; '>(</span>refBmp<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            refGraphics<span style='color:#808030; '>.</span>PageUnit <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>GraphicsUnit<span style='color:#808030; '>.</span>Point<span style='color:#800080; '>;</span>

            <span style='color:#800000; font-weight:bold; '>string</span> counterRotatedText <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>This text is rotated 45 degrees counter clockwise</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// measure the rotated text size</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>SizeF counterRotatedTextSize <span style='color:#808030; '>=</span> refGraphics<span style='color:#808030; '>.</span>MeasureString<span style='color:#808030; '>(</span>counterRotatedText<span style='color:#808030; '>,</span> sysFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> counterRotatedTextSize<span style='color:#808030; '>.</span>Width <span style='color:#808030; '>/</span> <span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>float</span><span style='color:#808030; '>)</span>Math<span style='color:#808030; '>.</span>Sqrt<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            <span style='color:#800000; font-weight:bold; '>string</span> clockwiseRotatedText <span style='color:#808030; '>=</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>This text is rotated 45 degrees clockwise</span><span style='color:#800000; '>"</span><span style='color:#800080; '>;</span>

            PdfText rotatedCounterClockwiseText <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>100</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> counterRotatedText<span style='color:#808030; '>,</span> pdfFontEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            rotatedCounterClockwiseText<span style='color:#808030; '>.</span>RotationAngle <span style='color:#808030; '>=</span> <span style='color:#008c00; '>45</span><span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>rotatedCounterClockwiseText<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            PdfText rotatedClockwiseText <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>100</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> clockwiseRotatedText<span style='color:#808030; '>,</span> pdfFontEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            rotatedClockwiseText<span style='color:#808030; '>.</span>RotationAngle <span style='color:#808030; '>=</span> <span style='color:#808030; '>-</span><span style='color:#008c00; '>45</span><span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>rotatedClockwiseText<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// measure the rotated text size</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>SizeF clockwiseRotatedTextSize <span style='color:#808030; '>=</span> refGraphics<span style='color:#808030; '>.</span>MeasureString<span style='color:#808030; '>(</span>clockwiseRotatedText<span style='color:#808030; '>,</span> sysFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> clockwiseRotatedTextSize<span style='color:#808030; '>.</span>Width <span style='color:#808030; '>/</span> <span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>float</span><span style='color:#808030; '>)</span>Math<span style='color:#808030; '>.</span>Sqrt<span style='color:#808030; '>(</span><span style='color:#008c00; '>2</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// dispose the graphics used for measuring</span>
            refGraphics<span style='color:#808030; '>.</span>Dispose<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            refBmp<span style='color:#808030; '>.</span>Dispose<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#region </span><span style='color:#696969; '>Layout an automatically paginated text</span>

            <span style='color:#800000; font-weight:bold; '>string</span> dummyBigText <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>IO<span style='color:#808030; '>.</span>File<span style='color:#808030; '>.</span>ReadAllText<span style='color:#808030; '>(</span>Server<span style='color:#808030; '>.</span>MapPath<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>~</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span> <span style='color:#808030; '>+</span> <span style='color:#800000; '>@"</span><span style='color:#0000e6; '>\DemoFiles\Text\DummyBigText.txt</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            PdfText titleTextPaginated <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos<span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span>
                    <span style='color:#800000; '>"</span><span style='color:#0000e6; '>The text below is automatically paginated when it gets to the bottom of this page:</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> pdfFontBoldEmbed<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            titleTextPaginated<span style='color:#808030; '>.</span>ForeColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>Navy<span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>titleTextPaginated<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

            PdfText paginatedText <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfText<span style='color:#808030; '>(</span>crtXPos <span style='color:#808030; '>+</span> <span style='color:#008c00; '>50</span><span style='color:#808030; '>,</span> crtYPos<span style='color:#808030; '>,</span> <span style='color:#008c00; '>300</span><span style='color:#808030; '>,</span> dummyBigText<span style='color:#808030; '>,</span> pdfFont<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            paginatedText<span style='color:#808030; '>.</span>BackColor <span style='color:#808030; '>=</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>Color<span style='color:#808030; '>.</span>WhiteSmoke<span style='color:#800080; '>;</span>
            paginatedText<span style='color:#808030; '>.</span>Cropping <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>false</span><span style='color:#800080; '>;</span>
            textLayoutInfo <span style='color:#808030; '>=</span> page1<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>paginatedText<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// get the last page where the text was rendered</span>
            PdfPage crtPage <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>Pages<span style='color:#808030; '>[</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageIndex<span style='color:#808030; '>]</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// draw a line at the bottom of the text on the second page</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>PointF leftPoint <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>PointF<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Left<span style='color:#808030; '>,</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Bottom<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>PointF rightPoint <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> System<span style='color:#808030; '>.</span>Drawing<span style='color:#808030; '>.</span>PointF<span style='color:#808030; '>(</span>textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Right<span style='color:#808030; '>,</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Bottom<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            PdfLine borderLine <span style='color:#808030; '>=</span> <span style='color:#800000; font-weight:bold; '>new</span> PdfLine<span style='color:#808030; '>(</span>leftPoint<span style='color:#808030; '>,</span> rightPoint<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            borderLine<span style='color:#808030; '>.</span>LineStyle<span style='color:#808030; '>.</span>LineWidth <span style='color:#808030; '>=</span> <span style='color:#008000; '>0.5</span><span style='color:#006600; '>f</span><span style='color:#800080; '>;</span>
            crtPage<span style='color:#808030; '>.</span>Layout<span style='color:#808030; '>(</span>borderLine<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

            <span style='color:#696969; '>// advance the Y position in the second PDF page</span>
            crtYPos <span style='color:#808030; '>+</span><span style='color:#808030; '>=</span> textLayoutInfo<span style='color:#808030; '>.</span>LastPageRectangle<span style='color:#808030; '>.</span>Height <span style='color:#808030; '>+</span> <span style='color:#008c00; '>10</span><span style='color:#800080; '>;</span>

<span style='color:#004a43; '>&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;&#xa0;#endregion</span>

            <span style='color:#800000; font-weight:bold; '>try</span>
            <span style='color:#800080; '>{</span>
                <span style='color:#696969; '>// write the PDF document to a memory buffer</span>
                <span style='color:#800000; font-weight:bold; '>byte</span><span style='color:#808030; '>[</span><span style='color:#808030; '>]</span> pdfBuffer <span style='color:#808030; '>=</span> document<span style='color:#808030; '>.</span>WriteToMemory<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

                <span style='color:#696969; '>// inform the browser about the binary data format</span>
                HttpContext<span style='color:#808030; '>.</span>Current<span style='color:#808030; '>.</span>Response<span style='color:#808030; '>.</span>AddHeader<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Content-Type</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> <span style='color:#800000; '>"</span><span style='color:#0000e6; '>application/pdf</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

                <span style='color:#696969; '>// let the browser know how to open the PDF document and the file name</span>
                HttpContext<span style='color:#808030; '>.</span>Current<span style='color:#808030; '>.</span>Response<span style='color:#808030; '>.</span>AddHeader<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>Content-Disposition</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span> String<span style='color:#808030; '>.</span>Format<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>attachment; filename=PdfText.pdf; size={0}</span><span style='color:#800000; '>"</span><span style='color:#808030; '>,</span>
                            pdfBuffer<span style='color:#808030; '>.</span>Length<span style='color:#808030; '>.</span>ToString<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

                <span style='color:#696969; '>// write the PDF buffer to HTTP response</span>
                HttpContext<span style='color:#808030; '>.</span>Current<span style='color:#808030; '>.</span>Response<span style='color:#808030; '>.</span>BinaryWrite<span style='color:#808030; '>(</span>pdfBuffer<span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>

                <span style='color:#696969; '>// call End() method of HTTP response to stop ASP.NET page processing</span>
                HttpContext<span style='color:#808030; '>.</span>Current<span style='color:#808030; '>.</span>Response<span style='color:#808030; '>.</span>End<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            <span style='color:#800080; '>}</span>
            <span style='color:#800000; font-weight:bold; '>finally</span>
            <span style='color:#800080; '>{</span>
                document<span style='color:#808030; '>.</span>Close<span style='color:#808030; '>(</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            <span style='color:#800080; '>}</span>
        <span style='color:#800080; '>}</span>

        <span style='color:#800000; font-weight:bold; '>protected</span> <span style='color:#800000; font-weight:bold; '>void</span> Page_Load<span style='color:#808030; '>(</span><span style='color:#800000; font-weight:bold; '>object</span> sender<span style='color:#808030; '>,</span> EventArgs e<span style='color:#808030; '>)</span>
        <span style='color:#800080; '>{</span>
            <span style='color:#800000; font-weight:bold; '>if</span> <span style='color:#808030; '>(</span><span style='color:#808030; '>!</span>IsPostBack<span style='color:#808030; '>)</span>
            <span style='color:#800080; '>{</span>
                Master<span style='color:#808030; '>.</span>SelectNode<span style='color:#808030; '>(</span><span style='color:#800000; '>"</span><span style='color:#0000e6; '>pdfText</span><span style='color:#800000; '>"</span><span style='color:#808030; '>)</span><span style='color:#800080; '>;</span>
            <span style='color:#800080; '>}</span>
        <span style='color:#800080; '>}</span>
    <span style='color:#800080; '>}</span>
<span style='color:#800080; '>}</span>
</pre>
